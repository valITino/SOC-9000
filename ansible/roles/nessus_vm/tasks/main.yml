---
- name: Ensure dependencies
  ansible.builtin.apt:
    name:
      - apt-transport-https
      - gnupg
      - lsb-release
    state: present
    update_cache: true

- name: Copy Nessus .deb from Windows mount (isos dir)
  vars:
    deb_name: "{{ lookup('env', 'NESSUS_DEB') | default('nessus_latest_amd64.deb') }}"
  ansible.builtin.copy:
    src: "/mnt/e/SOC-9000/isos/{{ deb_name }}"
    dest: "/tmp/{{ deb_name }}"
    mode: '0644'

- name: Install Nessus
  ansible.builtin.apt:
    deb: "/tmp/{{ lookup('env', 'NESSUS_DEB') | default('nessus_latest_amd64.deb') }}"
    state: present

- import_tasks: register.yml
